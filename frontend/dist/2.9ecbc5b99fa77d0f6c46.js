(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"49jh":function(e,t,r){"use strict";var n=r("CcnG"),i=r("A7o+"),o=r("Ip0R"),a=r("gIcY"),l=r("BxdG");r("RCMP"),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u}));var s=n["\u0275crt"]({encapsulation:0,styles:[[".form-control[_ngcontent-%COMP%]{padding:.38rem .75rem}"]],data:{}});function u(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,2,"small",[],null,null,null,null,null)),(e()(),n["\u0275ted"](1,null,[" "," "])),n["\u0275pid"](131072,i.j,[i.k,n.ChangeDetectorRef]),(e()(),n["\u0275eld"](3,0,null,null,9,"div",[["class","input-group"]],null,null,null,null,null)),(e()(),n["\u0275eld"](4,0,null,null,8,"input",[["class","form-control form-control-sm"],["placeholder",""],["type","text"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"input"],[null,"blur"],[null,"compositionstart"],[null,"compositionend"]],(function(e,t,r){var i=!0;return"input"===t&&(i=!1!==n["\u0275nov"](e,7)._handleInput(r.target.value)&&i),"blur"===t&&(i=!1!==n["\u0275nov"](e,7).onTouched()&&i),"compositionstart"===t&&(i=!1!==n["\u0275nov"](e,7)._compositionStart()&&i),"compositionend"===t&&(i=!1!==n["\u0275nov"](e,7)._compositionEnd(r.target.value)&&i),i}),null,null)),n["\u0275did"](5,278528,null,0,o.NgClass,[n.IterableDiffers,n.KeyValueDiffers,n.ElementRef,n.Renderer2],{klass:[0,"klass"],ngClass:[1,"ngClass"]},null),n["\u0275pod"](6,{"is-invalid":0}),n["\u0275did"](7,16384,null,0,a.DefaultValueAccessor,[n.Renderer2,n.ElementRef,[2,a.COMPOSITION_BUFFER_MODE]],null,null),n["\u0275prd"](1024,null,a.NG_VALUE_ACCESSOR,(function(e){return[e]}),[a.DefaultValueAccessor]),n["\u0275did"](9,540672,null,0,a.FormControlDirective,[[8,null],[8,null],[6,a.NG_VALUE_ACCESSOR],[2,a["\u0275angular_packages_forms_forms_p"]]],{form:[0,"form"]},null),n["\u0275prd"](2048,null,a.NgControl,null,[a.FormControlDirective]),n["\u0275did"](11,16384,null,0,a.NgControlStatus,[[4,a.NgControl]],null,null),n["\u0275did"](12,16384,null,0,l.a,[a.NgControl],{disableControl:[0,"disableControl"]},null)],(function(e,t){var r=t.component,n=e(t,6,0,r.parentFormControl.invalid);e(t,5,0,"form-control form-control-sm",n),e(t,9,0,r.parentFormControl),e(t,12,0,r.disabled)}),(function(e,t){e(t,1,0,n["\u0275unv"](t,1,0,n["\u0275nov"](t,2).transform("Releve.Observers"))),e(t,4,0,n["\u0275nov"](t,11).ngClassUntouched,n["\u0275nov"](t,11).ngClassTouched,n["\u0275nov"](t,11).ngClassPristine,n["\u0275nov"](t,11).ngClassDirty,n["\u0275nov"](t,11).ngClassValid,n["\u0275nov"](t,11).ngClassInvalid,n["\u0275nov"](t,11).ngClassPending)}))}},CMxW:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("CcnG"),i=(r("5nLG"),r("4R65")),o=r("qwng"),a=r("mFOs"),l=function(){function e(e,t){this.mapService=e,this._toasterService=t,this.editMode=!1,this.onLoad=new n.EventEmitter,this.onGeomChange=new n.EventEmitter}return e.prototype.ngOnInit=function(){this.style=this.style||this.mapService.searchStyle},e.prototype.ngAfterViewInit=function(){var e=this;this.mapService.initializefileLayerFeatureGroup(),this.map=this.mapService.getMap(),this.mapService.fileLayerEditionMode=this.editMode,a(null,i,o),i.Control.FileLayerLoad.LABEL='<img class="icon" width="15" src="assets/images/folder.svg" alt="file icon"/>',this.fileLayerControl=i.Control.fileLayerLoad({layer:i.geoJson,addToMap:!1,fileSizeLimit:10024,formats:[".gpx",".geojson",".kml"]}).addTo(this.map),this.fileLayerControl.loader.on("data:loaded",(function(t){var r;e.mapService.removeAllLayers(e.mapService.map,e.mapService.leafletDrawFeatureGroup),e.mapService.setEditingMarker(!1),e.mapService.removeAllLayers(e.mapService.map,e.mapService.fileLayerFeatureGroup);var n=[];for(var o in t.layer._layers){n.push(r=t.layer._layers[o].feature);var a=i.geoJSON(r,{pointToLayer:function(e,t){return i.circleMarker(t)},onEachFeature:function(t,n){var i="";for(var o in r.properties)i+="<b>"+o+"</b> : "+r.properties[o]+" <br>";n.on("contextmenu",(function(e){i.length>0&&(n.bindPopup(i),n.openPopup())})),e.editMode&&n.on("click",(function(t){e.previousCurrentLayer&&e.previousCurrentLayer.setStyle(e.style),n.setStyle({color:"red"}),e.previousCurrentLayer=n,e.mapService.firstLayerFromMap=!1,e.onGeomChange.emit(n.feature)}))},style:e.style});e.mapService.fileLayerFeatureGroup.addLayer(a),e.onLoad.emit(n)}e.previousLayer&&e.map.removeLayer(e.previousLayer),e.previousLayer=t.layer})),this.fileLayerControl.loader.on("data:error",(function(t){e._toasterService.error(t.error.message,"Erreur d'import"),console.error(t)}))},e.prototype.ngOnChanges=function(e){e&&e.removeLayer&&e.removeLayer.currentValue&&this.previousLayer&&this.map.removeLayer(this.previousLayer)},e}()},QqSC:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("CcnG"),i=(r("CMxW"),r("5nLG"),r("SZbH"),n["\u0275crt"]({encapsulation:2,styles:[],data:{}}));function o(e){return n["\u0275vid"](0,[],null,null)}},RCMP:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("mrSG"),i=function(e){function t(){return e.call(this)||this}return Object(n.c)(t,e),t.prototype.ngOnInit=function(){},t}(r("p2ub").a)},a4Ar:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r("5nLG"),r("bkLN");var n=function(){function e(e,t){this._ms=e,this.mapListService=t}return e.prototype.ngOnInit=function(){this.mapListService.idName=this.idName},e.prototype.ngAfterViewInit=function(){this.mapListService.enableMapListConnexion(this._ms.getMap())},e.prototype.onEachFeature=function(e,t){var r=this;this.mapListService.layerDict[e.id]=t,t.setStyle(this.mapListService.originStyle),t.on({click:function(n){r.mapListService.toggleStyle(t),r.mapListService.mapSelected.next(e.id),e.properties.leaflet_popup&&t.bindPopup(e.properties.leaflet_popup).openPopup()}})},e}()},mFOs:function(e,t,r){var n,i;!function(o,a){a.toGeoJSON?(n=[r("4R65")],void 0===(i=(function(e){o(e,a.toGeoJSON)}).apply(t,n))||(e.exports=i)):e.exports?e.exports=function(e,t,n){return void 0===t&&(t=void 0!==a?r("4R65"):r("4R65")(e)),void 0===n&&(n=void 0!==a?r("qwng"):r("qwng")(e)),o(t,n),t}:void 0!==a&&a.L&&a.toGeoJSON&&o(a.L,a.toGeoJSON)}((function(e,t){var r=e.Layer.extend({options:{layer:e.geoJson,layerOptions:{},fileSizeLimit:1024},initialize:function(t,r){this._map=t,e.Util.setOptions(this,r),this._parsers={geojson:this._loadGeoJSON,json:this._loadGeoJSON,gpx:this._convertToGeoJSON,kml:this._convertToGeoJSON}},load:function(t,r){var n,i;return!this._isParameterMissing(t,"file")&&!!this._isFileSizeOk(t.size)&&!!(n=this._getParser(t.name,r))&&((i=new FileReader).onload=e.Util.bind((function(e){var r;try{this.fire("data:loading",{filename:t.name,format:n.ext}),r=n.processor.call(this,e.target.result,n.ext),this.fire("data:loaded",{layer:r,filename:t.name,format:n.ext})}catch(i){this.fire("data:error",{error:i})}}),this),t.testing||i.readAsText(t),i)},loadMultiple:function(e,t){var r=[];if(e[0])for(e=Array.prototype.slice.apply(e);e.length>0;)r.push(this.load(e.shift(),t));return r},loadData:function(e,t,r){var n,i;if(!this._isParameterMissing(e,"data")&&!this._isParameterMissing(t,"name")&&this._isFileSizeOk(e.length)&&(n=this._getParser(t,r)))try{this.fire("data:loading",{filename:t,format:n.ext}),i=n.processor.call(this,e,n.ext),this.fire("data:loaded",{layer:i,filename:t,format:n.ext})}catch(o){this.fire("data:error",{error:o})}},_isParameterMissing:function(e,t){return void 0===e&&(this.fire("data:error",{error:new Error("Missing parameter: "+t)}),!0)},_getParser:function(e,t){var r;if(t=t||e.split(".").pop(),r=this._parsers[t])return{processor:r,ext:t};this.fire("data:error",{error:new Error("Unsupported file type ("+t+")")})},_isFileSizeOk:function(e){var t=(e/1024).toFixed(4);return!(t>this.options.fileSizeLimit&&(this.fire("data:error",{error:new Error("File size exceeds limit ("+t+" > "+this.options.fileSizeLimit+"kb)")}),1))},_loadGeoJSON:function(e){var t;if("string"==typeof e&&(e=JSON.parse(e)),0===(t=this.options.layer(e,this.options.layerOptions)).getLayers().length)throw new Error("GeoJSON has no valid layers.");return this.options.addToMap&&t.addTo(this._map),t},_convertToGeoJSON:function(e,r){var n;return"string"==typeof e&&(e=(new window.DOMParser).parseFromString(e,"text/xml")),n=t[r](e),this._loadGeoJSON(n)}}),n=e.Control.extend({statics:{TITLE:"Load local file (GPX, KML, GeoJSON)",LABEL:"&#8965;"},options:{position:"topleft",fitBounds:!0,layerOptions:{},addToMap:!0,fileSizeLimit:1024},initialize:function(t){e.Util.setOptions(this,t),this.loader=null},onAdd:function(t){return this.loader=e.FileLayer.fileLoader(t,this.options),this.loader.on("data:loaded",(function(e){this.options.fitBounds&&window.setTimeout((function(){t.fitBounds(e.layer.getBounds())}),500)}),this),this._initDragAndDrop(t),this._initContainer()},_initDragAndDrop:function(e){var t,r=this.loader,n=e._container,i={dragenter:function(){e.scrollWheelZoom.disable()},dragleave:function(){e.scrollWheelZoom.enable()},dragover:function(e){e.stopPropagation(),e.preventDefault()},drop:function(t){t.stopPropagation(),t.preventDefault(),r.loadMultiple(t.dataTransfer.files),e.scrollWheelZoom.enable()}};for(t in i)i.hasOwnProperty(t)&&n.addEventListener(t,i[t],!1)},_initContainer:function(){var t,r=this.loader,n="leaflet-control-filelayer leaflet-control-zoom",i=e.DomUtil.create("div",n+" leaflet-bar"),o=e.DomUtil.create("a",n+"-in leaflet-bar-part",i);return o.innerHTML=e.Control.FileLayerLoad.LABEL,o.href="#",o.title=e.Control.FileLayerLoad.TITLE,(t=e.DomUtil.create("input","hidden",i)).type="file",t.multiple="multiple",t.accept=this.options.formats?this.options.formats.join(","):".gpx,.kml,.json,.geojson",t.style.display="none",t.addEventListener("change",(function(){r.loadMultiple(this.files),this.value=""}),!1),e.DomEvent.disableClickPropagation(o),e.DomEvent.on(o,"click",(function(e){t.click(),e.preventDefault()})),i}});e.FileLayer={},e.FileLayer.FileLoader=r,e.FileLayer.fileLoader=function(t,r){return new e.FileLayer.FileLoader(t,r)},e.Control.FileLayerLoad=n,e.Control.fileLayerLoad=function(t){return new e.Control.FileLayerLoad(t)}}),window)},"pz+G":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));var n=r("CcnG"),i=(r("zjWw"),r("5nLG"),r("5weA"),n["\u0275crt"]({encapsulation:2,styles:[],data:{}}));function o(e){return n["\u0275vid"](0,[],null,null)}},t4k0:function(e,t,r){"use strict";var n=r("CcnG"),i=r("ZL0t"),o=r("EdRb"),a=r("t/Na"),l=r("5nLG"),s=r("5weA"),u=r("Ce+4"),c=r("iBZZ");r("a4Ar"),r("bkLN"),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return d}));var p=n["\u0275crt"]({encapsulation:0,styles:[[".list[_ngcontent-%COMP%]{height:94vh;overflow-y:auto}.map-content[_ngcontent-%COMP%]{margin-top:-5px}"]],data:{}});function d(e){return n["\u0275vid"](0,[(e()(),n["\u0275eld"](0,0,null,null,4,"pnx-map",[["class","map-card"]],null,null,null,i.b,i.a)),n["\u0275prd"](512,null,o.b,o.b,[a.c]),n["\u0275did"](2,114688,null,0,o.a,[l.a,s.a,a.c,o.b],{height:[0,"height"]},null),(e()(),n["\u0275eld"](3,0,null,null,1,"pnx-geojson",[],null,null,null,u.b,u.a)),n["\u0275did"](4,638976,null,0,c.a,[l.a],{geojson:[0,"geojson"],onEachFeature:[1,"onEachFeature"]},null)],(function(e,t){var r=t.component;e(t,2,0,r.height),e(t,4,0,r.mapListService.geojsonData,r.onEachFeature.bind(r))}),null)}},zjWw:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("CcnG"),i=(r("5nLG"),r("2urx")),o=r("4R65"),a=(r("5weA"),function(){function e(e,t){this.mapservice=e,this._commonService=t,this.defaultEnable=!0,this.markerChanged=new n.EventEmitter}return e.prototype.ngOnInit=function(){var e=this;this.map=this.mapservice.map,this.zoomLevel=this.zoomLevel||i.a.MAPCONFIG.ZOOM_LEVEL_RELEVE,this.setMarkerLegend(),this.defaultEnable?this.enableMarkerOnClick():this.changeMarkerButtonColor(!1),this.mapservice.isMarkerEditing$.subscribe((function(t){e.toggleEditing(t)}))},e.prototype.setMarkerLegend=function(){var e=this,t=this.mapservice.addCustomLegend("topleft","markerLegend","url(assets/images/location-pointer.png)");this.map.addControl(new t),document.getElementById("markerLegend").style.backgroundColor="#c8c8cc",o.DomEvent.disableClickPropagation(document.getElementById("markerLegend")),document.getElementById("markerLegend").onclick=function(){e.toggleEditing(!0)}},e.prototype.enableMarkerOnClick=function(){var e=this;this.map.on("click",(function(t){e.mapservice.firstLayerFromMap=!1,e.map.getZoom()<e.zoomLevel?e._commonService.translateToaster("warning","Map.ZoomWarning"):e.generateMarkerAndEvent(t.latlng.lng,t.latlng.lat)}))},e.prototype.generateMarkerAndEvent=function(e,t){void 0!==this.mapservice.marker?(this.mapservice.marker.remove(),this.mapservice.marker=this.mapservice.createMarker(e,t,!0).addTo(this.map),this.previousCoord=[e,t],this.markerMoveEvent(this.mapservice.marker)):(this.mapservice.marker=this.mapservice.createMarker(e,t,!0).addTo(this.map),this.markerMoveEvent(this.mapservice.marker)),this.mapservice.firstLayerFromMap=!1,this.markerChanged.emit(this.markerToGeojson(this.mapservice.marker.getLatLng()))},e.prototype.markerMoveEvent=function(e){var t=this;e.on("moveend",(function(e){t.map.getZoom()<t.zoomLevel?(t._commonService.translateToaster("warning","Map.ZoomWarning"),t.mapservice.marker.remove(),t.mapservice.marker=t.mapservice.createMarker(t.previousCoord[0],t.previousCoord[1],!0),t.map.addLayer(t.mapservice.marker),t.markerMoveEvent(t.mapservice.marker)):t.markerChanged.emit(t.markerToGeojson(t.mapservice.marker.getLatLng()))}))},e.prototype.changeMarkerButtonColor=function(e){document.getElementById("markerLegend").style.backgroundColor=e?"#c8c8cc":"white"},e.prototype.toggleEditing=function(e){this.mapservice.editingMarker=e,this.changeMarkerButtonColor(this.mapservice.editingMarker),this.mapservice.editingMarker?(this.mapservice.removeAllLayers(this.map,this.mapservice.leafletDrawFeatureGroup),this.mapservice.removeAllLayers(this.map,this.mapservice.fileLayerFeatureGroup),this.enableMarkerOnClick()):(this.mapservice.map.off("click"),void 0!==this.mapservice.marker&&(this.mapservice.marker.off("moveend"),this.map.removeLayer(this.mapservice.marker)))},e.prototype.markerToGeojson=function(e){return{geometry:{type:"Point",coordinates:[e.lng,e.lat]}}},e.prototype.ngOnChanges=function(e){if(e.coordinates&&e.coordinates.currentValue){var t=e.coordinates.currentValue;this.mapservice.zoomOnMarker(t,this.zoomToLocationLevel),this.previousCoord=t,this.generateMarkerAndEvent(t[0],t[1])}},e}())}}]);